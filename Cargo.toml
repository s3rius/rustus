[package]
name = "rustus"
version = "0.4.6"
edition = "2021"
description = "TUS protocol implementation written in Rust."

[[bin]]
name = "rustus"

[dependencies]
async-trait = "0.1.52"
base64 = "^0.13.0"
lazy_static = "1.4.0"
log = "^0.4.14"
serde_json = "1"
strfmt = "^0.1.6"
thiserror = "^1.0"
url = "2.2.2"

[dependencies.futures]
version = "0.3.21"

[dependencies.serde]
version = "1"
features = ["derive"]

[dependencies.openssl]
version = "0.10.38"
features = ["vendored"]

[dependencies.actix-files]
version = "0.6.0-beta.13"

[dependencies.actix-web]
version = "^4.0.0-rc.3"

[dependencies.chrono]
features = ["serde"]
version = "^0.4.19"

[dependencies.derive_more]
default-features = false
features = ["display", "from", "from_str"]
version = "^0.99.9"

[dependencies.fern]
features = ["colored"]
version = "0.6.0"

[dependencies.lapin]
optional = true
version = "^1.9.0"

[dependencies.mobc-lapin]
optional = true
version = "0.7.0"

[dependencies.mobc-redis]
optional = true
version = "^0.7.0"

[dependencies.rbatis]
default-features = false
features = ["runtime-actix-rustls", "all-database"]
optional = true
version = "^3.0"

[dependencies.rbson]
optional = true
version = "2.0"

[dependencies.reqwest]
features = ["json"]
optional = true
version = "^0.11.8"

[dependencies.structopt]
version = "^0.3"

[dependencies.strum]
features = ["derive"]
version = "0.23"

[dependencies.tokio]
features = ["time", "process"]
version = "1.4.0"

[dependencies.tokio-amqp]
optional = true
version = "1.0.0"

[dependencies.uuid]
features = ["v4"]
version = "^1.0.0-alpha.1"

[features]
all = ["redis_info_storage", "db_info_storage", "http_notifier", "amqp_notifier"]
amqp_notifier = ["lapin", "tokio-amqp", "mobc-lapin"]
db_info_storage = ["rbatis", "rbson"]
default = []
http_notifier = ["reqwest"]
redis_info_storage = ["mobc-redis"]

### For testing
test_redis = []
test_db = []
test_rmq = []
integration_tests = ["test_redis", "test_db", "test_rmq"]

[dev-dependencies]
tempdir = "0.3.7"
actix-rt = "2.6.0"
httptest = "0.15.4"

[profile]
[profile.release]
lto = true
panic = "abort"
opt-level = 3
codegen-units = 1
