
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="How to configure Rusts">
      
      
      
        <link rel="canonical" href="https://s3rius.github.io/rustus/configuration/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../deploy/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Configuration - rustus</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuring-server" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="rustus" class="md-header__button md-logo" aria-label="rustus" data-md-component="logo">
      
  <img src="../imgs/logo_horizontal.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rustus
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuration
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/s3rius/rustus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    s3rius/rustus
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="rustus" class="md-nav__button md-logo" aria-label="rustus" data-md-component="logo">
      
  <img src="../imgs/logo_horizontal.svg" alt="logo">

    </a>
    rustus
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/s3rius/rustus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    s3rius/rustus
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome page
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-server" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sentry-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Sentry integration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring storage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-storage" class="md-nav__link">
    <span class="md-ellipsis">
      File storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-s3-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid-S3 storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-storage" class="md-nav__link">
    <span class="md-ellipsis">
      S3 Storage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-info-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring info storage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring info storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-info-storage" class="md-nav__link">
    <span class="md-ellipsis">
      File info storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis-info-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Redis info storage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-tus" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring TUS
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up hooks
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-server" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sentry-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Sentry integration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring storage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-storage" class="md-nav__link">
    <span class="md-ellipsis">
      File storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-s3-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid-S3 storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-storage" class="md-nav__link">
    <span class="md-ellipsis">
      S3 Storage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-info-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring info storage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring info storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-info-storage" class="md-nav__link">
    <span class="md-ellipsis">
      File info storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis-info-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Redis info storage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-tus" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring TUS
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Configuration</h1>

<p>Rustus is highly configurable. You can adjust it with CLI or you can use environment variables.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Information about hooks you can find on <a href="../hooks/">Hooks page</a>.</p>
</div>
<h2 id="configuring-server">Configuring server</h2>
<p>We use actix to run server.
You can configure on which <code>host</code> and <code>port</code> rustus is listening.
Also you can configure number of actix <code>workers</code> that handle connections.</p>
<p><code>--max-body-size</code> is the max number of bytes that users can send in request body.</p>
<p><code>--url</code> is a base URL for all tus requests.</p>
<p><code>--workers</code> by default is equal to number of physical CPU cores. Edit it carefully.</p>
<p><code>--cors</code> is a list of allowed hosts with wildcards separated by commas. By default all hosts are allowed.
You can define which hosts are allowed for your particular application.</p>
<p><code>--allow-empty</code> is a parameter that allows users to upload empty files. Empty
file means that while creation 0 bytes was passed as an <code>Upload-Length</code>.</p>
<p>For example if you add <code>--cors "*.staging.domain,*.prod.domain"</code>, it allows all origins
like <code>my.staging.domain</code> or <code>my.prod.domain</code>, but it will refuse to serve other origins.</p>
<p>Also you can disable access log for <code>/health</code> endpoint, by using <code>--disable-health-access-log</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">CLI</label><label for="__tabbed_1_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>rustus<span class="w"> </span>--host<span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span>--port<span class="w"> </span><span class="m">1081</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span>--workers<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span>--max-body-size<span class="w"> </span><span class="m">1000000</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span>--url<span class="w"> </span><span class="s2">&quot;/files&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span>--log-level<span class="w"> </span><span class="s2">&quot;INFO&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span>--cors<span class="w"> </span><span class="s2">&quot;my.*.domain.com,your.*.domain.com&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span>--disable-health-access-log<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span>--allow-empty
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span>--max-file-size<span class="w"> </span><span class="m">10000000</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_SERVER_HOST</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_SERVER_PORT</span><span class="o">=</span><span class="s2">&quot;1081&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_SERVER_WORKERS</span><span class="o">=</span><span class="s2">&quot;8&quot;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_MAX_BODY_SIZE</span><span class="o">=</span><span class="s2">&quot;1000000&quot;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_URL</span><span class="o">=</span><span class="s2">&quot;/files&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_LOG_LEVEL</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_CORS</span><span class="o">=</span><span class="s2">&quot;my.*.domain.com,your.*.domain.com&quot;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_DISABLE_HEALTH_ACCESS_LOG</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_ALLOW_EMPTY</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_MAX_FILE_SIZE</span><span class="o">=</span><span class="s2">&quot;10000000&quot;</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h2 id="sentry-integration">Sentry integration</h2>
<p>If you have sentry and want to see all erros in your sentry project,
please provide sentry-dsn to rustus.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">CLI</label><label for="__tabbed_2_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>rustus<span class="w"> </span>--sentry-dsn<span class="w"> </span><span class="s2">&quot;https://user@sentry-instance.com/11&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span>--sentry-sample-rate<span class="w"> </span><span class="m">1</span>.0
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_SENTRY_DSN</span><span class="o">=</span><span class="s2">&quot;https://user@sentry-instance.com/11&quot;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_SENTRY_SAMPLE_RATE</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h2 id="configuring-storage">Configuring storage</h2>
<p>Storages are used to actually store your files. You can configure where you want
to store files. By default in uses <code>file-storage</code> and stores every upload on
your local file system.</p>
<p>Availabe storages:</p>
<ul>
<li><a href="#file-storage">file-storage</a></li>
<li><a href="#hybrid-s3-storage">hybrid-s3</a></li>
<li><a href="#s3-storage">s3</a></li>
</ul>
<h3 id="file-storage">File storage</h3>
<p>File storage parameters:</p>
<ul>
<li><code>--data-dir</code> - path to the directory where all files are stored;</li>
<li><code>--dir-structure</code> - pattern of a directory structure inside data dir;</li>
<li><code>--force-fsync</code> - calls fsync system call after every write to disk.
``
You can use variables within the pattern.</li>
</ul>
<p>Available variables:</p>
<ul>
<li><code>{year}</code> - current year;</li>
<li><code>{month}</code> - current month number from 1 to 12;</li>
<li><code>{day}</code> - current day number from 1 to 31;</li>
<li><code>{hour}</code> - hour number from 0 to 23;</li>
<li><code>{minute}</code> - minute number from 0 to 59;</li>
</ul>
<p>For example if you use <code>files/{year}/{month}/{day}</code> as your dir-structure, rustus stores files like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>tree<span class="w"> </span>data
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>data
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>└──<span class="w"> </span>files
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span>└──<span class="w"> </span><span class="m">2022</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">        </span>└──<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">            </span>└──<span class="w"> </span><span class="m">8</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">                </span>├──<span class="w"> </span>0bd911d4054d41c6a3ad54be67ee3e66
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">                </span>└──<span class="w"> </span>5bc9c62384494c439e2a064b82a39cc6
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">CLI</label><label for="__tabbed_3_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>rustus<span class="w"> </span>--force-fsync<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span>--storage<span class="w"> </span><span class="s2">&quot;file-storage&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span>--data-dir<span class="w"> </span><span class="s2">&quot;./data/&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span>--dir-structure<span class="w"> </span><span class="s2">&quot;{year}/{month}/{day}&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_STORAGE</span><span class="o">=</span><span class="s2">&quot;file-storage&quot;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_DATA_DIR</span><span class="o">=</span><span class="s2">&quot;./data/&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_DIR_STRUCTURE</span><span class="o">=</span><span class="s2">&quot;{year}/{month}/{day}&quot;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_FORCE_FSYNC</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h3 id="hybrid-s3-storage">Hybrid-S3 storage</h3>
<p>This storage stores files locally and uploads resulting file on S3 when the upload is finished.
It has no restriction on chunk size and you can make chunks less than 5MB.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>When choosing this storage you still need to have a
connected shared directory between instances.</p>
<p>This storage is not intended to be used for large files,
since it uploads files to S3 during the last request.</p>
</div>
<p>Hybrid-S3 uses file-storage inside, so all parameters from file storage
also applied to it.</p>
<p>Parameters:</p>
<ul>
<li><code>--dir-structure</code> - pattern of a directory structure locally and on s3;</li>
<li><code>--data-dir</code> - path to the local directory where all files are stored;</li>
<li><code>--force-fsync</code> - calls fsync system call after every write to disk in local storage;</li>
<li><code>--s3-url</code> -  s3 endpoint URL;</li>
<li><code>--s3-bucket</code> - name of a bucket to use;</li>
<li><code>--s3-region</code> - AWS region to use;</li>
<li><code>--s3-access-key</code> - S3 access key;</li>
<li><code>--s3-access-key-path</code> - S3 access key path;</li>
<li><code>--s3-secret-key</code> - S3 secret key;</li>
<li><code>--s3-secret-key-path</code> - S3 secret key path;</li>
<li><code>--s3-security-token</code> - s3 secrity token;</li>
<li><code>--s3-session-token</code> - S3 session token;</li>
<li><code>--s3-profile</code> - Name of the section from <code>~/.aws/credentials</code> file;</li>
<li><code>--s3-headers</code> - JSON object with additional header to every S3 request (Useful for setting ACLs);</li>
<li><code>--s3-force-path-style</code> - use path style URL. It appends bucket name at the end of the URL;</li>
</ul>
<p>Required parameter are only <code>--s3-url</code> and <code>--s3-bucket</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">CLI</label><label for="__tabbed_4_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>rustus<span class="w"> </span>--storage<span class="w"> </span><span class="s2">&quot;hybrid-s3&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span>--s3-url<span class="w"> </span><span class="s2">&quot;https://localhost:9000&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span>--s3-bucket<span class="w"> </span><span class="s2">&quot;bucket&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span>--s3-region<span class="w"> </span><span class="s2">&quot;eu-central1&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span>--s3-access-key<span class="w"> </span><span class="s2">&quot;fJljHcXo07rqIOzh&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span>--s3-access-key-path<span class="w"> </span><span class="s2">&quot;/run/agenix/S3_ACCESS_KEY&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">    </span>--s3-secret-key<span class="w"> </span><span class="s2">&quot;6BJfBUL18nLiGmF5zKW0NKrdxQVxNYWB&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span>--s3-secret-key-path<span class="w"> </span><span class="s2">&quot;/run/agenix/S3_SECRET_KEY&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span>--s3-profile<span class="w"> </span><span class="s2">&quot;my_profile&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">    </span>--s3-security-token<span class="w"> </span><span class="s2">&quot;token&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span>--s3-session-token<span class="w"> </span><span class="s2">&quot;token&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">    </span>--s3-force-path-style<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">    </span>--s3-headers<span class="w"> </span><span class="s1">&#39;{&quot;x-amz-acl&quot;: &quot;public-read&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span>--force-fsync<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">    </span>--data-dir<span class="w"> </span><span class="s2">&quot;./data/&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">    </span>--dir-structure<span class="w"> </span><span class="s2">&quot;{year}/{month}/{day}&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_STORAGE</span><span class="o">=</span><span class="s2">&quot;hybrid-s3&quot;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_URL</span><span class="o">=</span><span class="s2">&quot;https://localhost:9000&quot;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_BUCKET</span><span class="o">=</span><span class="s2">&quot;bucket&quot;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_REGION</span><span class="o">=</span><span class="s2">&quot;eu-central1&quot;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_ACCESS_KEY</span><span class="o">=</span><span class="s2">&quot;fJljHcXo07rqIOzh&quot;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_ACCESS_KEY_PATH</span><span class="o">=</span><span class="s2">&quot;/run/agenix/S3_ACCESS_KEY&quot;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SECRET_KEY</span><span class="o">=</span><span class="s2">&quot;6BJfBUL18nLiGmF5zKW0NKrdxQVxNYWB&quot;</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SECRET_KEY_PATH</span><span class="o">=</span><span class="s2">&quot;/run/agenix/S3_SECCRET_KEY&quot;</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SECURITY_TOKEN</span><span class="o">=</span><span class="s2">&quot;token&quot;</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SESSION_TOKEN</span><span class="o">=</span><span class="s2">&quot;token&quot;</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_PROFILE</span><span class="o">=</span><span class="s2">&quot;my_profile&quot;</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_HEADERS</span><span class="o">=</span><span class="s1">&#39;{&quot;x-amz-acl&quot;: &quot;public-read&quot;}&#39;</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_DATA_DIR</span><span class="o">=</span><span class="s2">&quot;./data/&quot;</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_DIR_STRUCTURE</span><span class="o">=</span><span class="s2">&quot;{year}/{month}/{day}&quot;</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_FORCE_FSYNC</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_FORCE_PATH_STYLE</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h3 id="s3-storage">S3 Storage</h3>
<p>This storage uploads files directly to S3 without creating temporary files on filesystem.
This might be a better solution for you if you use S3 as underlying object storage,
but it has a disadvantage.</p>
<div class="admonition warning">
<p class="admonition-title">Be aware</p>
<p>This storage can only upload chunks that are greater than <code>5MB</code> each,
except for the last one. Therefore, for all your TUS client libraries,
you should set the chunk size to at least <code>5,000,000</code> bytes</p>
</div>
<p>If you want to allow users to upload smaller chunks, consider using <a href="#hybrid-s3-storage">hybrid-s3</a>.</p>
<p>Parameters:</p>
<ul>
<li><code>--s3-url</code> -  s3 endpoint URL;</li>
<li><code>--s3-bucket</code> - name of a bucket to use;</li>
<li><code>--s3-region</code> - AWS region to use;</li>
<li><code>--s3-access-key</code> - S3 access key;</li>
<li><code>--s3-access-key-path</code> - S3 access key path;</li>
<li><code>--s3-secret-key</code> - S3 secret key;</li>
<li><code>--s3-secret-key-path</code> - S3 secret key path;</li>
<li><code>--s3-security-token</code> - s3 secrity token;</li>
<li><code>--s3-session-token</code> - S3 session token;</li>
<li><code>--s3-profile</code> - Name of the section from <code>~/.aws/credentials</code> file;</li>
<li><code>--s3-headers</code> - JSON object with additional header to every S3 request (Useful for setting ACLs);</li>
<li><code>--s3-force-path-style</code> - use path style URL. It appends bucket name at the end of the URL;</li>
<li><code>--dir-structure</code> - pattern of a directory structure on s3;</li>
</ul>
<p>Required parameter are only <code>--s3-url</code> and <code>--s3-bucket</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">CLI</label><label for="__tabbed_5_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>rustus<span class="w"> </span>--storage<span class="w"> </span><span class="s2">&quot;s3&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span>--s3-url<span class="w"> </span><span class="s2">&quot;https://localhost:9000&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span>--s3-bucket<span class="w"> </span><span class="s2">&quot;bucket&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span>--s3-region<span class="w"> </span><span class="s2">&quot;eu-central1&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span>--s3-access-key<span class="w"> </span><span class="s2">&quot;fJljHcXo07rqIOzh&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span>--s3-access-key-path<span class="w"> </span><span class="s2">&quot;/run/agenix/S3_ACCESS_KEY&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span>--s3-secret-key<span class="w"> </span><span class="s2">&quot;6BJfBUL18nLiGmF5zKW0NKrdxQVxNYWB&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span>--s3-secret-key-path<span class="w"> </span><span class="s2">&quot;/run/agenix/S3_SECRET_KEY&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span>--s3-profile<span class="w"> </span><span class="s2">&quot;my_profile&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span>--s3-security-token<span class="w"> </span><span class="s2">&quot;token&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span>--s3-session-token<span class="w"> </span><span class="s2">&quot;token&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span>--s3-force-path-style<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span>--s3-headers<span class="w"> </span><span class="s1">&#39;{&quot;x-amz-acl&quot;: &quot;public-read&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span>--dir-structure<span class="w"> </span><span class="s2">&quot;{year}/{month}/{day}&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_STORAGE</span><span class="o">=</span><span class="s2">&quot;s3&quot;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_URL</span><span class="o">=</span><span class="s2">&quot;https://localhost:9000&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_BUCKET</span><span class="o">=</span><span class="s2">&quot;bucket&quot;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_REGION</span><span class="o">=</span><span class="s2">&quot;eu-central1&quot;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_ACCESS_KEY</span><span class="o">=</span><span class="s2">&quot;fJljHcXo07rqIOzh&quot;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_ACCESS_KEY_PATH</span><span class="o">=</span><span class="s2">&quot;/run/agenix/S3_ACCESS_KEY&quot;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SECRET_KEY</span><span class="o">=</span><span class="s2">&quot;6BJfBUL18nLiGmF5zKW0NKrdxQVxNYWB&quot;</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SECRET_KEY_PATH</span><span class="o">=</span><span class="s2">&quot;/run/agenix/S3_SECCRET_KEY&quot;</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SECURITY_TOKEN</span><span class="o">=</span><span class="s2">&quot;token&quot;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_SESSION_TOKEN</span><span class="o">=</span><span class="s2">&quot;token&quot;</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_PROFILE</span><span class="o">=</span><span class="s2">&quot;my_profile&quot;</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_HEADERS</span><span class="o">=</span><span class="s1">&#39;{&quot;x-amz-acl&quot;: &quot;public-read&quot;}&#39;</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_S3_FORCE_PATH_STYLE</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_DIR_STRUCTURE</span><span class="o">=</span><span class="s2">&quot;{year}/{month}/{day}&quot;</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h2 id="configuring-info-storage">Configuring info storage</h2>
<p>Info storages are used to store information
about file uploads. These storages <strong>must</strong> be persistent,
because every time chunk is uploaded rustus updates information
about upload. And when someone wants to download file, information
about it requested from storage to get actual path of an upload.</p>
<p>Available info storages:</p>
<ul>
<li><a href="#file-info-storage">file-info-storage</a> - stores information in files on disk;</li>
<li><a href="#redis-info-storage">redis-info-storage</a> - information is stored in Redis;</li>
</ul>
<h3 id="file-info-storage">File info storage</h3>
<p>file info storage stores information in files on disk.
It's default info storage. Every download has it's own associated file.
All .info files stored in flat structure so it's the least preferable way of
storing information about uploads. But if you don't plan to have many uploads, it may fit well.</p>
<p><code>--info-dir</code> - directory where all .info file will be stored (default is <code>./data</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">CLI</label><label for="__tabbed_6_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>rustus<span class="w"> </span>--info-storage<span class="w"> </span><span class="s2">&quot;file-info-storage&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span>--info-dir<span class="w"> </span><span class="s2">&quot;./data&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_INFO_STORAGE</span><span class="o">=</span><span class="s2">&quot;file-info-storage&quot;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_INFO_DIR</span><span class="o">=</span><span class="s2">&quot;./data&quot;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h3 id="redis-info-storage">Redis info storage</h3>
<p>Redis db is a good way to store information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you're using Redis as a cluster
you must provide connection string for master Redis server.
Since rustus need to have latest information and it writes a lot.</p>
</div>
<p>Configuration parameters:</p>
<ul>
<li><code>--info-db-dsn</code> - connection string for your Redis database.
    It's required if <code>redis-info-storage</code> is chosen.</li>
<li><code>--redis-info-expiration</code> - number of seconds when key will expire.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">CLI</label><label for="__tabbed_7_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>rustus<span class="w"> </span>--info-storage<span class="w"> </span><span class="s2">&quot;redis-info-storage&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span>--info-db-dsn<span class="w"> </span><span class="s2">&quot;redis://localhost/0&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span>--redis-info-expiration<span class="w"> </span><span class="m">100</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_INFO_STORAGE</span><span class="o">=</span><span class="s2">&quot;redis-info-storage&quot;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_INFO_DB_DSN</span><span class="o">=</span><span class="s2">&quot;redis://localhost&quot;</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_REDIS_INFO_EXPIRATION</span><span class="o">=</span><span class="s2">&quot;100&quot;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>rustus
</code></pre></div>
</div>
</div>
</div>
<h2 id="configuring-tus">Configuring TUS</h2>
<p>Since TUS protocol offers extensibility you can turn off some protocol extensions.</p>
<p>Available extensions:</p>
<ul>
<li><code>getting</code> - Rustus specific extension that helps you download uploaded files with get request;</li>
<li><code>creation</code> - helps you to create files (It's like a core feature you better have this enabled);</li>
<li><code>termination</code> - allows you to delete uploads with DELETE request;</li>
<li><code>creation-with-upload</code> - allows you to write first bytes of a file while creating;</li>
<li><code>creation-defer-length</code> - allows you to create file without specifying file length;</li>
<li><code>concatenation</code> - allows you to concatenate finished partial uploads.</li>
<li><code>checksum</code> - allows you to verify checksum of every batch.</li>
</ul>
<p>You can read more about extensions on <a href="https://tus.io/protocols/resumable-upload.html#protocol-extensions">official web-site</a>.</p>
<p><code>--tus-extensions</code> - a list of enabled extensions.
<code>--remove-parts</code> - remove parts files after successful concatenation (disabled by default).</p>
<p>By default all extensions are enabled.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">CLI</label><label for="__tabbed_8_2">ENV</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>rustus<span class="w"> </span>--remove-parts<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span>--tus-extensions<span class="w"> </span><span class="s2">&quot;getting,creation,termination,creation-with-upload,creation-defer-length,concatenation,checksum&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_TUS_EXTENSIONS</span><span class="o">=</span><span class="s2">&quot;getting,creation,termination,creation-with-upload,creation-defer-length,concatenation,checksum&quot;</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RUSTUS_REMOVE_PARTS</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>rustus
</code></pre></div>
</div>
</div>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "search.suggest", "header.autohide"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>